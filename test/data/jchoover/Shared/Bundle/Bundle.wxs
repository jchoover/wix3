<?xml version="1.0" encoding="UTF-8"?>
<Wix 
  xmlns="http://schemas.microsoft.com/wix/2006/wi" 
  xmlns:bal="http://schemas.microsoft.com/wix/BalExtension"
  xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  
	<Bundle Name="Bootstrapper" Version="$(var.Version)" Manufacturer="Some Random Company Inc." UpgradeCode="$(var.UpgradeCode)">

    <?if ($(var.Version) ~= 1.3.0.0) or ($(var.Version) ~= 1.3.1.0)?>
      <RelatedBundle Id="$(var.UpgradeCode_1_2)" Action="Detect"/>
    <?endif ?>
    <!-- To probe for existing install ini (User configurable settings post install) -->
    <Variable Name="PRIOR_INSTALL_DIR" /> 
    <!-- Optionally allow older Major.Minor instances of the application -->
    <Variable Name="REMOVE_OLDER_VERSIONS" Value="1" Type="numeric" Persisted="shared" bal:Overridable="yes"  />
    <!-- Configuration for the application to check for automatic updates on startup -->
    <Variable Name="AUTOMATICUPDATE" Value="1" Type="numeric" Persisted="shared" bal:Overridable="yes"  />
    
    <Variable Name="InstallOptionA" Type="string" Persisted="shared" Value="Option A"/>
    <Variable Name="InstallOptionB" Type="numeric" Persisted="shared" Value="1"/>
    <Variable Name="InstallOptionC" Type="version" Persisted="shared" Value="1.0.0.1"/>
    
    <!--<Variable Name="InstallOptionC" Type="version" Persisted="shared" Value="v1.1.2.1"/>-->
    <!-- <RelatedBundle Id="$(var.BundleUpgradeCode)" Action="Upgrade"/> -->
    
    <util:DirectorySearch Id="vUpdateDir" Path="[ProgramFilesFolder]Some Random Company Inc.\App" Variable="PRIOR_INSTALL_DIR"  />
    
		<BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.RtfLicense">
      <bal:WixStandardBootstrapperApplication	LicenseFile="License Agreement.rtf" LogoFile="logo.png" SuppressOptionsUI="no" ThemeFile="RtfTheme.xml"  LocalizationFile="RtfTheme.wxl" />
			<Payload Name="bafunctions.dll" SourceFile="..\Debug\BAFunctions.dll" Compressed="yes" />
		</BootstrapperApplicationRef>

		<Chain>
			<!-- TODO: Define the list of chained packages. -->
      <MsiPackage SourceFile="..\Package\bin\Debug\Package.msi" Compressed="yes">
        <MsiProperty Name="AUTOMATICUPDATE" Value="[AUTOMATICUPDATE]"/>
        <MsiProperty Name="BUNDLE_UPGRADE_CODE" Value="$(var.UpgradeCode)"/>
      </MsiPackage>
		</Chain>
	</Bundle>
</Wix>
